# Version Management with Versioneer

This project uses **Versioneer** to automatically manage versions from Git tags.

## How it works

Versioneer automatically generates version numbers based on:
- The latest Git tag (format `vX.Y.Z`, e.g., `v0.1.0`)
- The number of commits since that tag
- The current commit hash
- The working tree state (clean or dirty)

### Version format

- **Official release** (with tag): `0.1.0`
- **Development version**: `0.1.0+1.g1c17761`
  - `0.1.0` = latest tag
  - `+1` = 1 commit after the tag
  - `g1c17761` = Git commit hash
- **Modified working tree**: `0.1.0+1.g1c17761.dirty`

## Creating a new version

### 1. Make your changes and commits

```bash
git add .
git commit -m "Your changes"
```

### 2. Create a tag for the new version

```bash
# For a minor version (0.1.0 -> 0.2.0)
git tag v0.2.0

# For a patch version (0.1.0 -> 0.1.1)
git tag v0.1.1

# For a major version (0.1.0 -> 1.0.0)
git tag v1.0.0
```

### 3. Push tags to remote

```bash
git push origin --tags
```

### 4. Reinstall the tool

```bash
uv tool install --reinstall --force .
```

## Check the version

```bash
# Via command
cbz-convertor --version

# Via Python
python -c "import cbz_convertor; print(cbz_convertor.__version__)"
```

## Files generated by Versioneer

- `versioneer.py` - Version management script (at root)
- `cbz_convertor/_version.py` - Generated version module
- `.gitattributes` - Configuration for export-subst

**These files are automatically generated and must be committed to the repository.**

## Configuration

Versioneer configuration is in `pyproject.toml`:

```toml
[tool.versioneer]
VCS = "git"
style = "pep440"
versionfile_source = "cbz_convertor/_version.py"
versionfile_build = "cbz_convertor/_version.py"
tag_prefix = "v"
parentdir_prefix = "cbz_convertor-"
```

## Recommended semantic versioning

- **MAJOR** (X.0.0): Breaking changes incompatible with previous versions
- **MINOR** (0.X.0): New backward-compatible features
- **PATCH** (0.0.X): Backward-compatible bug fixes

## Example workflow

```bash
# Development in progress
git commit -m "Add new feature"
# Version: 0.1.0+1.g1c17761

git commit -m "Fix bug"
# Version: 0.1.0+2.g2d28872

# Ready for release
git tag v0.2.0
git push origin --tags
# Version: 0.2.0

# Continue development
git commit -m "Start new feature"
# Version: 0.2.0+1.g3e39983
```

## Troubleshooting

### Version displays ".dirty"
This means you have uncommitted changes. Run `git status` to see what hasn't been committed.

### Version doesn't change after a new tag
Reinstall with: `uv tool install --reinstall --force .`

### Installation fails with "ModuleNotFoundError: No module named 'versioneer'"
Versioneer must be in `build-system.requires` in `pyproject.toml` (already configured).


